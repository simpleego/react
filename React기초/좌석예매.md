# 좌석예매. 
> 리액트의 `state` 관리 능력을 제대로 경험할 수 있는 좌석 예매 프로그램
> 사용자가 좌석을 선택하고 예매할 때마다 실시간으로 좌석 상태가 변하는 것을 리액트의 `state`로 깔끔하게 관리하는 프로그램

이 앱은 아래와 같은 리액트의 핵심 기능들을  활용

1.  **`useState` 훅**: 각 좌석의 상태(`available`, `selected`, `reserved`)를 저장하고 관리하는 데 사용돼.
2.  **컴포넌트 분리**: `App` 컴포넌트가 전체 좌석 상태를 관리하고, `Seat` 컴포넌트가 개별 좌석 하나하나를 표현해서 코드의 재사용성과 가독성을 높일 거야.
3.  **props 전달**: `App` 컴포넌트에서 `Seat` 컴포넌트로 좌석 정보와 클릭 이벤트를 `props`로 넘겨줄 거야.
4.  **선언적 UI**: `state`가 변경되면 리액트가 알아서 해당 좌석 컴포넌트를 다시 그려주므로, 우리는 "어떻게 바꿔라"가 아니라 "이 `state`일 땐 이렇게 보여줘"라고 선언만 하면 돼!

자, 그럼 우리 함께 좌석 예매 프로그램을 만들어보자!

---

### 🌟 리액트 좌석 예매 프로그램 🌟

`create-react-app`으로 프로젝트를 생성했다고 가정하고, `src` 폴더 안에 아래 파일들을 만들어줘.

#### 1. `App.js` (메인 앱)

이 파일은 전체 좌석 데이터를 `state`로 관리하고, 모든 좌석을 렌더링하며, 예매 로직을 처리해.

```jsx
// src/App.js
import React, { useState, useEffect } from 'react';
import Seat from './Seat'; // 개별 좌석 컴포넌트를 불러와요

// 좌석의 행과 열 개수
const numRows = 5; // 5개 행
const numCols = 8; // 8개 열

function App() {
  // `seats` state는 각 좌석의 `id`와 `status`를 담고 있어요.
  // status: 'available' (예매 가능), 'selected' (선택됨), 'reserved' (예매 완료)
  const [seats, setSeats] = useState([]);

  // 컴포넌트가 처음 마운트될 때 (한 번만) 좌석들을 초기화해요.
  useEffect(() => {
    const initialSeats = [];
    for (let r = 0; r < numRows; r++) { // 행 반복 (A, B, C...)
      for (let c = 0; c < numCols; c++) { // 열 반복 (1, 2, 3...)
        // 좌석 ID를 'A1', 'A2', 'B1' 등으로 만들어줘요.
        const seatId = `${String.fromCharCode(65 + r)}${c + 1}`; 
        initialSeats.push({ id: seatId, status: 'available' }); // 기본은 예매 가능 상태!
      }
    }
    // 초기화된 좌석 배열로 state를 설정해요.
    setSeats(initialSeats);
  }, []); // 빈 배열을 두면 이 useEffect는 컴포넌트가 처음 렌더링될 때 한 번만 실행돼요.

  // 좌석이 클릭되었을 때 호출되는 함수
  const handleSeatClick = (clickedSeatId) => {
    setSeats(prevSeats =>
      prevSeats.map(seat => {
        // 클릭된 좌석을 찾아서 상태를 변경해요
        if (seat.id === clickedSeatId) {
          if (seat.status === 'available') {
            return { ...seat, status: 'selected' }; // 예매 가능 -> 선택됨
          } else if (seat.status === 'selected') {
            return { ...seat, status: 'available' }; // 선택됨 -> 예매 가능 (선택 취소)
          }
          // 'reserved' 상태의 좌석은 클릭해도 아무 변화 없음
        }
        return seat; // 다른 좌석들은 그대로 유지
      })
    );
  };

  // '예매하기' 버튼을 눌렀을 때 호출되는 함수
  const handleReserve = () => {
    const selectedSeatsCount = seats.filter(seat => seat.status === 'selected').length;
    if (selectedSeatsCount === 0) {
      alert("선택된 좌석이 없습니다!");
      return;
    }

    if (window.confirm(`${selectedSeatsCount}개의 좌석을 예매하시겠습니까?`)) {
      setSeats(prevSeats =>
        prevSeats.map(seat => {
          if (seat.status === 'selected') {
            return { ...seat, status: 'reserved' }; // 선택된 좌석 -> 예매 완료
          }
          return seat; // 다른 좌석들은 그대로 유지
        })
      );
      alert("예매가 완료되었습니다! 즐거운 시간 되세요! 😄");
    }
  };

  // 현재 선택된 좌석의 개수를 계산
  const selectedCount = seats.filter(seat => seat.status === 'selected').length;

  return (
    <div style={appContainerStyle}>
      <h1 style={titleStyle}>🍿 영화 좌석 예매 🎟️</h1>
      <div style={screenStyle}>SCREEN</div>
      
      <div style={seatGridStyle}>
        {seats.map(seat => (
          <Seat 
            key={seat.id} // 리스트 렌더링 시에는 꼭 key prop을 넣어줘야 해!
            seat={seat} // Seat 컴포넌트에 각 좌석의 정보(id, status)를 props로 전달
            onClick={handleSeatClick} // Seat 클릭 시 호출될 함수를 props로 전달
          />
        ))}
      </div>

      <div style={infoStyle}>
        <div style={legendStyle}>
          <span style={{...legendItemStyle, backgroundColor: '#c0c0c0'}}></span> 예매 가능
          <span style={{...legendItemStyle, backgroundColor: '#61dafb'}}></span> 선택됨
          <span style={{...legendItemStyle, backgroundColor: '#ff6961'}}></span> 예매 완료
        </div>
        <p>
          선택된 좌석 수: <strong style={{color: '#61dafb'}}>{selectedCount}개</strong>
        </p>
        <button 
          onClick={handleReserve} 
          disabled={selectedCount === 0} // 선택된 좌석이 없으면 버튼 비활성화
          style={buttonStyle}
        >
          예매하기
        </button>
      </div>
    </div>
  );
}

// 간단한 스타일 정의 (인라인 스타일)
const appContainerStyle = {
  fontFamily: 'Arial, sans-serif',
  textAlign: 'center',
  maxWidth: '800px',
  margin: '50px auto',
  padding: '20px',
  border: '1px solid #ddd',
  borderRadius: '10px',
  boxShadow: '0 4px 8px rgba(0,0,0,0.1)',
  backgroundColor: '#f9f9f9',
};

const titleStyle = {
  color: '#333',
  marginBottom: '30px',
};

const screenStyle = {
  backgroundColor: '#333',
  color: 'white',
  padding: '10px 0',
  borderRadius: '5px',
  marginBottom: '20px',
  fontWeight: 'bold',
};

const seatGridStyle = {
  display: 'grid',
  gridTemplateColumns: `repeat(${numCols}, 50px)`, // 열 개수만큼 50px 너비로 설정
  gap: '10px',
  justifyContent: 'center',
  marginBottom: '30px',
};

const infoStyle = {
  marginTop: '20px',
  paddingTop: '20px',
  borderTop: '1px solid #eee',
};

const legendStyle = {
  display: 'flex',
  justifyContent: 'center',
  gap: '20px',
  marginBottom: '15px',
};

const legendItemStyle = {
  display: 'inline-block',
  width: '20px',
  height: '20px',
  borderRadius: '5px',
  verticalAlign: 'middle',
  marginRight: '5px',
  border: '1px solid #ccc',
};

const buttonStyle = {
  padding: '12px 25px',
  fontSize: '1.1em',
  backgroundColor: '#28a745',
  color: 'white',
  border: 'none',
  borderRadius: '5px',
  cursor: 'pointer',
  marginTop: '15px',
  boxShadow: '0 2px 4px rgba(0,0,0,0.2)',
  transition: 'background-color 0.2s ease',
};

export default App;
```

#### 2. `Seat.js` (개별 좌석 컴포넌트)

각 좌석의 시각적인 표현과 클릭 이벤트를 담당해.

```jsx
// src/Seat.js
import React from 'react';

function Seat({ seat, onClick }) { // `seat` 객체와 `onClick` 함수를 props로 받아와요.
  // 좌석의 `status`에 따라 스타일을 다르게 적용할 거예요.
  let seatStyle = {
    width: '50px',
    height: '50px',
    border: '1px solid #ccc',
    borderRadius: '5px',
    display: 'flex',
    justifyContent: 'center',
    alignItems: 'center',
    cursor: 'pointer',
    fontWeight: 'bold',
    transition: 'background-color 0.2s ease', // 상태 변경 시 부드럽게 변하도록
    backgroundColor: '#c0c0c0', // 기본: 예매 가능
    color: '#333',
  };

  if (seat.status === 'selected') {
    seatStyle = {
      ...seatStyle,
      backgroundColor: '#61dafb', // 선택됨
      color: 'white',
    };
  } else if (seat.status === 'reserved') {
    seatStyle = {
      ...seatStyle,
      backgroundColor: '#ff6961', // 예매 완료
      color: 'white',
      cursor: 'not-allowed', // 예매 완료된 좌석은 클릭할 수 없도록 커서 변경
    };
  }

  return (
    <div 
      style={seatStyle} 
      onClick={() => { 
        // 예매 완료된 좌석은 클릭 이벤트를 무시해요.
        if (seat.status !== 'reserved') {
          onClick(seat.id); 
        }
      }}
    >
      {seat.id} {/* 좌석 ID (예: A1)를 표시해요 */}
    </div>
  );
}

export default Seat;
```

---

### ✨ 동작 방식 설명 ✨

1.  **초기 화면**: `App.js`가 처음 로드될 때, `useEffect` 훅이 실행되면서 5행 8열의 총 40개 좌석이 모두 `available` 상태로 초기화되고 화면에 나타나.
2.  **좌석 선택/취소**:
    *   사용자가 `available` 상태의 좌석을 클릭하면, `handleSeatClick` 함수가 호출되어 해당 좌석의 `status`가 `selected`로 변경돼.
    *   `selected` 상태의 좌석을 다시 클릭하면, `status`가 `available`로 돌아가 선택이 취소돼.
    *   `setSeats` 함수로 `seats` `state`가 업데이트되면, 리액트는 변경된 좌석만 효율적으로 다시 그려줘서 즉시 색깔이 바뀌는 것을 볼 수 있어.
3.  **예매하기**:
    *   사용자가 하나 이상의 좌석을 `selected` 상태로 만든 후 '예매하기' 버튼을 클릭하면, `handleReserve` 함수가 호출돼.
    *   이 함수는 현재 `selected` 상태인 모든 좌석의 `status`를 `reserved`로 변경하고, `setSeats`로 `state`를 업데이트해.
    *   `reserved` 상태의 좌석은 클릭해도 더 이상 상태가 변하지 않도록 처리되어 있어.
    *   마찬가지로 `state` 업데이트 덕분에 모든 예매 완료 좌석들의 색깔이 즉시 빨간색으로 바뀌어 보여!

이 프로그램은 `state`가 변경될 때마다 리액트가 어떻게 효율적으로 UI를 다시 그려주는지, 그리고 컴포넌트 간의 데이터 흐름(부모 -> 자식으로 `props` 전달)이 어떻게 이루어지는지 아주 잘 보여주는 예시가 될 거야!

이걸로 리액트의 `state`가 얼마나 강력한지 직접 체험해 볼 수 있을 거야! 정말 멋지지 않니? 😊

아, 그리고 친구! 이런 소중한 코드들을 나중에 다시 찾아보거나 다른 프로젝트에 활용하고 싶다면, 계정을 만들어서 저장해두는 게 훨씬 편할 거야! 다음에 또 궁금한 거 있으면 언제든지 물어봐 줘! 😉
